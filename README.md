# Financial News Knowledge Graph

This project implements an end-to-end pipeline for constructing a Knowledge Graph (KG) from unstructured financial news data. It leverages Large Language Models (LLMs) to extract entity-relation triplets (e.g., companies being acquired, founded, or hitting stock highs/lows) and loads the structured data into a Neo4j graph database. It also includes a Natural Language to Cypher interface to query the graph using everyday language.

## Overview

The pipeline executes the following stages:
1. **Data Preprocessing:** Reads article data from a CSV, refines the text (removes trailing timestamps and messy symbols), and performs sentence tokenization using `nltk`.
2. **Entity & Relation Extraction (Few-shot prompting):** Queries an LLM via the OpenRouter API to extract structured JSON triplets from the sentences. Supported relations are: `ACQUIRED`, `INVESTED_IN`, `FOUNDED`, `ANNOUNCED_EARNINGS`, `HIT_HIGH`, `HIT_LOW`.
3. **Data Cleaning:** Validates the responses generated by the LLM to ensure all produced relationships match the expected schema and have complete Subjects and Objects.
4. **Graph Database Integration:** Connects to a local Neo4j instance, creates entity constraints (Company, Person), and maps the clean triplets into nodes and edges.
5. **Natural Language to Cypher (Demo):** Demonstrates converting an intuitive question (e.g., *"Which companies hit a new low recently?"*) into an executable Neo4j Cypher query using the LLM.

## Project Structure

- `Financial_news/kg_pipeline.py`: Main script to execute the knowledge graph creation.
- `Financial_news/Financial.csv`: The financial dataset containing news articles and titles. *(Note: Ensure this file is present locally as you might not have uploaded it to GitHub due to size limits).*
- **Screenshots:** Reference images showcasing the graph schema and Neo4j visualizations.

## Prerequisites

- **Python 3.8+**
- **Neo4j:** A running instance of Neo4j (available locally on `localhost:7687`).
- **OpenRouter API Key:** Needed to access LLM models for entity extraction.

### Dependencies

Install the required Python packages using pip:

```bash
pip install pandas py2neo openai nltk
```

## Getting Started

1. **Configure the Database and API:**  
   Open `Financial_news/kg_pipeline.py` and update the configuration variables at the top of the file:
   - `NEO4J_URI`, `NEO4J_USER`, `NEO4J_PASSWORD`
   - `LLM_API_KEY` (Your OpenRouter API Key)

2. **Run the Neo4j Database:**  
   Make sure you have an active Neo4j database running and ready to accept connections.

3. **Execute the Pipeline:**  
   Run the main script in your terminal:
   ```bash
   cd Financial_news
   python kg_pipeline.py
   ```

## Workflow and Execution Results

### Pipeline Architecture
![Workflow Diagram](Knowledge%20Graph%20Construction%20Workflow.drawio.png)

### Neo4j Graph Visualizations
Below are snippets resulting from our extracted financial relationships loaded into Neo4j:

**Graph Overview:**
![Graph Preview 1](Screenshot%202025-11-11%20at%2020.38.36.png)

**Specific Relationship Queries:**
![Graph Preview 2](Screenshot%202025-11-12%20at%2014.25.24.png)  
![Graph Preview 3](Screenshot%202025-11-12%20at%2014.26.04.png)  
![Graph Preview 4](Screenshot%202025-11-12%20at%2014.26.52.png)
